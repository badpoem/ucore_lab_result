练习0

- 使用meld对实验1 2 3编写的代码merge到实验4代码中。

>

练习1

设计实现过程：

- 实现在注释中已经很详细地进行了说明。由于fork得到的进程proc处于尚未初始化状态，故为进程proc相应的各成员变量赋初值即可。

>

struct context context和struct trapframe *tf成员变量含义和在本实验中的作用

- context成员变量为8个寄存器的值，用于在进程切换的时候保存上下文以便保持与恢复现场。
- *tf表示进程的中断帧，记录内核的代码段与数据段等参数，指定线程运行的入口地址。

>

练习2

设计实现过程：

- 按照注释实现即可。为新创建的内核线程进行初始化，并且分配相应的内存资源，唤醒并且返回新进程号。

>

ucore是否做到给每个新fork的线程一个唯一的id

- 是的。
- get_pid函数中，每次遍历整个进程链表确保每个现有进程的pid与选中的last_pid不同。

>

练习3

在本实验的执行过程中，创建且运行了几个内核线程？

- 2个
- 分别是idleproc与initproc。

>

语句local_intr_save(intr_flag);....local_intr_restore(intr_flag);在这里有何作用?

- 用于关闭中断和恢复中断
- lab4中，ucore在向终端输出字符、分配物理页帧、释放页、进程调度时都会先关闭中断，操作完成后再开启中断。

>

区别于参考答案：

- 没有太大的区别。因为注释已经非常详细。

>

实验知识点

- 进程的创建、初始化、内存资源的分配

>

OS原理知识点

- 进程间的状态切换

>
